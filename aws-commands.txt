## create sns topic 
aws --profile=localstack sns create-topic --name=notification --endpoint-url=http://localhost:4566

## create sqs queue 
aws --profile=localstack sqs create-queue --queue-name=notification-queue-sns --endpoint-url=http://localhost:4566

## list sns topic subscriptions 
aws --profile=localstack sns list-subscriptions --endpoint-url=http://localhost:4566

## get Queue ARN SQS
aws --profile=localstack sqs get-queue-attributes --queue-url=http://sqs.us-east-1.localhost.localstack.cloud:4566/000000000000/notification-queue-sns --attribute-names=QueueArn --endpoint-url=http://localhost:4566

## subscribe sqs to sns topic 
aws --profile=localstack sns subscribe --topic-arn=arn:aws:sns:us-east-1:000000000000:notification --protocol=sqs --notification-endpoint=arn:aws:sqs:us-east-1:000000000000:notification-queue-sns --endpoint-url=http://localhost:4566

## create lambda function
aws --profile=localstack lambda create-function --function-name localstack-lambda-with-sqs-trigger --runtime java21 --role arn:aws:iam::000000000000:role/example-lambda-noop-role --handler com.example.lambda.SQSQueueHandler --zip-file fileb:///Users/erick/Documents/Workspace/Personal/Java/aws/spring-aws-lambda/target/spring-aws-lambda-0.0.1-SNAPSHOT-jar-with-dependencies.jar --timeout 120 --endpoint-url=http://localhost:4566

## configure source for lambda
aws --profile=localstack lambda create-event-source-mapping --function-name=localstack-lambda-with-sqs-trigger --batch-size 10 --event-source-arn arn:aws:sqs:us-east-1:000000000000:notification-queue-sns --endpoint-url=http://localhost:4566

## Send a message to test lambda function
aws --profile localstack sqs send-message  --queue-url=http://sqs.us-east-1.localhost.localstack.cloud:4566/000000000000/notification-queue-sns --message-body 'Hello, Erick' --endpoint-url=http://localhost:4566

## List event source mapping, if there are save the GUID
aws --profile localstack lambda list-event-source-mappings --function-name localstack-lambda-with-sqs-trigger --endpoint-url=http://localhost:4566 --no-sign-request

## Delete event source mappins with UUID
aws --profile localstack lambda delete-event-source-mapping --uuid c6f6d9ef-xxxx-xxxx-xxxx-xxxxxxxxxxxx --endpoint-url=http://localhost:4566 --no-sign-request

## Delete lambda function
aws --profile localstack lambda delete-function --function-name localstack-lambda-with-sqs-trigger --endpoint-url=http://localhost:4566

## Get the queue url
aws --profile localstack sqs get-queue-url --queue-name my-queue --endpoint-url=http://localhost:4566 --no-sign-request

## Delete the queue using the url
aws --profile localstack sqs delete-queue --queue-url http://localhost:4566/000000000000/my-queue --endpoint-url=http://localhost:4566 --no-sign-request

## List documents of a bucket
aws --profile localstack s3api list-objects-v2 --bucket nombre-del-bucket --endpoint-url=http://localhost:4566

## Delete documents from a bucket
aws --profile localstack s3 rm s3://nombre-del-bucket --recursive --endpoint-url=http://localhost:4566

## Delete a bucket
aws --profile localstack s3api delete-bucket --bucket nombre-del-bucket --endpoint-url=http://localhost:4566


## List s3 buckets
aws --profile localstack s3api list-buckets --endpoint-url=http://localhost:4566


aws --profile localstack dynamodb delete-table --table-name user-service --endpoint-url=http://localhost:4566
aws --profile localstack dynamodb create-table --table-name user-service --attribute-definitions AttributeName=leaseKey,AttributeType=S --key-schema AttributeName=leaseKey,KeyType=HASH --billing-mode PAY_PER_REQUEST --endpoint-url=http://localhost:4566